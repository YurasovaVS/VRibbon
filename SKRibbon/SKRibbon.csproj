<?xml version="1.0" encoding="utf-8"?>
<Project Sdk="Microsoft.NET.Sdk">

	<PropertyGroup>
		<ResolveAssemlyWarningOnErrorOnTargetArchitectureMismatch>None</ResolveAssemlyWarningOnErrorOnTargetArchitectureMismatch>
		<AppendTargetFrameworkToOutputPath>false</AppendTargetFrameworkToOutputPath>
		<TargetFramework>net48</TargetFramework>
		<OutputType>Library</OutputType>
		<UseWindowsForms>true</UseWindowsForms>
		<Configurations>Debug 2021;2021;Debug 2024;2024</Configurations>
	</PropertyGroup>
	
	<!-- RevitVersion -->
	<Choose>		
		<When Condition="$(Configuration.Contains('2021'))">
			<PropertyGroup>
				<RevitVersion>2021</RevitVersion>
				<TargetFramework>net48</TargetFramework>
			</PropertyGroup>
		</When>		
		<When Condition="$(Configuration.Contains('2024'))">
			<PropertyGroup>
				<RevitVersion>2024</RevitVersion>
				<TargetFramework>net48</TargetFramework>
			</PropertyGroup>
		</When>
		<Otherwise>
			<PropertyGroup>
				<RevitVersion>2021</RevitVersion>
				<TargetFramework>net48</TargetFramework>
			</PropertyGroup>
		</Otherwise>
	</Choose>

	<!-- Release -->
	<PropertyGroup Condition="!$(Configuration.Contains('Debug'))">
		<Optimize>true</Optimize>
		<OutputPath>bin\Release\$(RevitVersion)\</OutputPath>
		<DefineConstants>REVIT$(RevitVersion)</DefineConstants>
		<NoWarn>MSB3052</NoWarn>
		<DebugType>None</DebugType>
	</PropertyGroup>

	<!-- Debug -->
	<PropertyGroup Condition="$(Configuration.Contains('Debug'))">
		<DebugSymbols>true</DebugSymbols>
		<OutputPath>bin\Debug\</OutputPath>
		<DefineConstants>DEBUG;TRACE;REVIT$(RevitVersion)</DefineConstants>
		<DebugType>Full</DebugType>
	</PropertyGroup>

	<!-- DebugRevitVersion -->
	<PropertyGroup>
		<DebugRevitVersion>$(RevitVersion)</DebugRevitVersion>
		<StartAction>Program</StartAction>
		<StartProgram>$(ProgramW6432)\Autodesk\Revit $(DebugRevitVersion)\Revit.exe</StartProgram>
	</PropertyGroup>
	
	<!--
	
  <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <ProjectGuid>{74EA6100-7942-4C37-8722-8D539A0F9B1C}</ProjectGuid>
    <AppDesignerFolder>Properties</AppDesignerFolder>
    <RootNamespace>SKRibbon</RootNamespace>
    <AssemblyName>SKRibbon</AssemblyName>
    <FileAlignment>512</FileAlignment>
    <Deterministic>true</Deterministic>
  </PropertyGroup>

	<PropertyGroup Condition=" '$(RevitVersion)' == '2021' ">
		<PlatformTarget>x64</PlatformTarget>
		<DefineConstants>$(DefineConstants);REVIT2021</DefineConstants>
		<OutputPath>bin\$(Configuration)\2021</OutputPath>
	</PropertyGroup>

	<PropertyGroup Condition=" '$(RevitVersion)' == '2024' ">
		<PlatformTarget>x64</PlatformTarget>
		<DefineConstants>$(DefineConstants);REVIT2024</DefineConstants>
		<OutputPath>bin\$(Configuration)\2024</OutputPath>
	</PropertyGroup>
	
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
    <DebugSymbols>true</DebugSymbols>
    <DebugType>full</DebugType>
    <Optimize>false</Optimize>
    <OutputPath>bin\Debug\</OutputPath>
    <DefineConstants>DEBUG;TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
	
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
    <DebugType>pdbonly</DebugType>
    <Optimize>true</Optimize>
    <OutputPath>bin\Release\</OutputPath>
    <DefineConstants>TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  
	<ItemGroup Condition=" '$(RevitVersion)' == '2021' ">

		<Reference Include="RevitAPI">
			<HintPath>..\..\..\..\..\..\Program Files\Autodesk\Revit 2021\RevitAPI.dll</HintPath>
			<Private>False</Private>
		</Reference>
		
		<Reference Include="RevitAPIIFC">
			<HintPath>..\..\..\..\..\..\Program Files\Autodesk\Revit 2021\RevitAPIIFC.dll</HintPath>
			<Private>False</Private>
		</Reference>

		<Reference Include="RevitAPIUI">
			<HintPath>..\..\..\..\..\..\Program Files\Autodesk\Revit 2021\RevitAPIUI.dll</HintPath>
			<Private>False</Private>
		</Reference>

		<Reference Include="UIFramework">
			<HintPath>..\..\..\..\..\..\Program Files\Autodesk\Revit 2021\UIFramework.dll</HintPath>
			<Private>False</Private>
		</Reference>

		<Reference Include="Xceed.Wpf.AvalonDock">
			<HintPath>..\..\..\..\..\..\Program Files\Autodesk\Revit 2021\Xceed.Wpf.AvalonDock.dll</HintPath>
			<Private>False</Private>
		</Reference>
		
	</ItemGroup>

	<ItemGroup Condition=" '$(RevitVersion)' == '2024' ">

		<Reference Include="RevitAPI">
			<HintPath>..\..\..\..\..\..\Program Files\Autodesk\Revit 2024\RevitAPI.dll</HintPath>
			<Private>False</Private>
		</Reference>

		<Reference Include="RevitAPIIFC">
			<HintPath>..\..\..\..\..\..\Program Files\Autodesk\Revit 2024\RevitAPIIFC.dll</HintPath>
			<Private>False</Private>
		</Reference>

		<Reference Include="RevitAPIUI">
			<HintPath>..\..\..\..\..\..\Program Files\Autodesk\Revit 2024\RevitAPIUI.dll</HintPath>
			<Private>False</Private>
		</Reference>

		<Reference Include="UIFramework">
			<HintPath>..\..\..\..\..\..\Program Files\Autodesk\Revit 2024\UIFramework.dll</HintPath>
			<Private>False</Private>
		</Reference>

		<Reference Include="Xceed.Wpf.AvalonDock">
			<HintPath>..\..\..\..\..\..\Program Files\Autodesk\Revit 2024\Xceed.Wpf.AvalonDock.dll</HintPath>
			<Private>False</Private>
		</Reference>

	</ItemGroup>
-->
	<ItemGroup>
		<PackageReference Include="Microsoft.Office.Interop.Excel" Version="15.0.4795.1001" />
		<PackageReference Include="Revit_All_Main_Versions_API_x64" Version="$(RevitVersion).*" IncludeAssets="build; compile" PrivateAssets="All" />
	
	</ItemGroup>
	
	<ItemGroup Condition=" '$(RevitVersion)' == '2021' ">
		
		<Reference Include="RevitAPIIFC">
			<HintPath>..\..\..\..\..\..\Program Files\Autodesk\Revit 2021\RevitAPIIFC.dll</HintPath>
			<Private>False</Private>
		</Reference>
		
		<Reference Include="UIFramework">
			<HintPath>..\..\..\..\..\..\Program Files\Autodesk\Revit 2021\UIFramework.dll</HintPath>
			<Private>False</Private>
		</Reference>

		<Reference Include="Xceed.Wpf.AvalonDock">
			<HintPath>..\..\..\..\..\..\Program Files\Autodesk\Revit 2021\Xceed.Wpf.AvalonDock.dll</HintPath>
			<Private>False</Private>
		</Reference>

	</ItemGroup>

	<ItemGroup Condition=" '$(RevitVersion)' == '2024' ">

		<Reference Include="RevitAPIIFC">
			<HintPath>..\..\..\..\..\..\Program Files\Autodesk\Revit 2024\RevitAPIIFC.dll</HintPath>
			<Private>False</Private>
		</Reference>		

		<Reference Include="UIFramework">
			<HintPath>..\..\..\..\..\..\Program Files\Autodesk\Revit 2024\UIFramework.dll</HintPath>
			<Private>False</Private>
		</Reference>

		<Reference Include="Xceed.Wpf.AvalonDock">
			<HintPath>..\..\..\..\..\..\Program Files\Autodesk\Revit 2024\Xceed.Wpf.AvalonDock.dll</HintPath>
			<Private>False</Private>
		</Reference>
	</ItemGroup>
	

	<ItemGroup>
    <Reference Include="Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c, processorArchitecture=MSIL">
      <HintPath>..\packages\Microsoft.Office.Interop.Excel.15.0.4795.1001\lib\net20\Microsoft.Office.Interop.Excel.dll</HintPath>
      <EmbedInteropTypes>True</EmbedInteropTypes>
    </Reference>
    <Reference Include="PresentationCore" />
    <Reference Include="PresentationFramework" />	  
    <Reference Include="System" />
    <Reference Include="System.Core" />
    <Reference Include="System.Drawing" />
    <Reference Include="System.Windows.Forms" />
    <Reference Include="System.Xml.Linq" />
    <Reference Include="System.Data.DataSetExtensions" />
    <Reference Include="Microsoft.CSharp" />
    <Reference Include="System.Data" />
    <Reference Include="System.Net.Http" />
    <Reference Include="System.Xml" />	  
    <Reference Include="WindowsBase" /> 	  
  </ItemGroup>
	
  <ItemGroup><!--
    <Compile Include="Forms\PlaceFloorsForm.cs">
      <SubType>Form</SubType>
    </Compile>
    <Compile Include="Forms\PlaceFloorsForm.Designer.cs">
      <DependentUpon>PlaceFloorsForm.cs</DependentUpon>
    </Compile>
    <Compile Include="Functions\CreateRoomSchedules.cs" />
    <Compile Include="Forms\CreateRoomSchedulesForm.cs">
      <SubType>Form</SubType>
    </Compile>
    <Compile Include="Forms\CreateRoomSchedulesForm.Designer.cs">
      <DependentUpon>CreateRoomSchedulesForm.cs</DependentUpon>
    </Compile>
    <Compile Include="Functions\FixMirroredDoors.cs" />
    <Compile Include="Forms\FixMirroredDoorsForm.cs">
      <SubType>Form</SubType>
    </Compile>
    <Compile Include="Forms\FixMirroredDoorsForm.Designer.cs">
      <DependentUpon>FixMirroredDoorsForm.cs</DependentUpon>
    </Compile>
    <Compile Include="Forms\BatchDwgExportForm.cs">
      <SubType>Form</SubType>
    </Compile>
    <Compile Include="Forms\BatchDwgExportForm.Designer.cs">
      <DependentUpon>BatchDwgExportForm.cs</DependentUpon>
    </Compile>
    <Compile Include="Functions\BatchDwgExport.cs" />
    <Compile Include="ElemTrackTest.cs" />
    <Compile Include="Forms\InfoForm.cs">
      <SubType>Form</SubType>
    </Compile>
    <Compile Include="Forms\InfoForm.Designer.cs">
      <DependentUpon>InfoForm.cs</DependentUpon>
    </Compile>
    <Compile Include="Functions\Info.cs" />
    <Compile Include="Functions\PlaceFloors.cs" />
    <Compile Include="Functions\NumerateRooms.cs" />
    <Compile Include="Forms\NumerateRoomsForm.cs">
      <SubType>Form</SubType>
    </Compile>
    <Compile Include="Forms\NumerateRoomsForm.Designer.cs">
      <DependentUpon>NumerateRoomsForm.cs</DependentUpon>
    </Compile>
    <Compile Include="Utils\MJMCustomPrintForm.cs" />
    <Compile Include="Utils\FormUtils.cs" />
    <Compile Include="Functions\FillStamps.cs" />
    <Compile Include="Forms\FillStampsForm.cs">
      <SubType>Form</SubType>
    </Compile>
    <Compile Include="Forms\FillStampsForm.Designer.cs" />
    <Compile Include="Forms\ChangeColorSettingsForm.cs">
      <SubType>Form</SubType>
    </Compile>
    <Compile Include="Forms\ChangeColorSettingsForm.Designer.cs">
      <DependentUpon>ChangeColorSettingsForm.cs</DependentUpon>
    </Compile>
    <Compile Include="Functions\ChangeTabColorSettings.cs" />
    <Compile Include="Functions\ColorizeTabs.cs" />
    <Compile Include="Functions\FilterByPeople.cs" />
    <Compile Include="Forms\FilterByPeopleForm.cs">
      <SubType>Form</SubType>
    </Compile>
    <Compile Include="Forms\FilterByPeopleForm.Designer.cs" />
    <Compile Include="Functions\CreateInfoList.cs" />
    <Compile Include="Forms\BatchPrintForm.cs">
      <SubType>Form</SubType>
    </Compile>
    <Compile Include="Forms\BatchPrintForm.Designer.cs" />
    <Compile Include="Functions\BatchPrintSheets.cs" />
    <Compile Include="Forms\CopyListsForm.Designer.cs" />
    <Compile Include="Functions\CopyLists.cs" />
    <Compile Include="Forms\CopyListsForm.cs">
      <SubType>Form</SubType>
    </Compile>
    <Compile Include="Forms\AddSigForm.cs">
      <SubType>Form</SubType>
    </Compile>
    <Compile Include="Forms\AddSigForm.Designer.cs">
      <DependentUpon>AddSigForm.cs</DependentUpon>
    </Compile>
    <Compile Include="Forms\DeleteSigForm.cs">
      <SubType>Form</SubType>
    </Compile>
    <Compile Include="Forms\DeleteSigForm.Designer.cs">
      <DependentUpon>DeleteSigForm.cs</DependentUpon>
    </Compile>
    <Compile Include="Functions\ReplaceTags.cs" />
    <Compile Include="Forms\replaceTagsForm.cs">
      <SubType>Form</SubType>
    </Compile>
    <Compile Include="Forms\replaceTagsForm.Designer.cs" />
    <Compile Include="Functions\AdjustExistingAreas.cs" />
    <Compile Include="Forms\NewTotalForm.cs">
      <SubType>Form</SubType>
    </Compile>
    <Compile Include="Forms\NewTotalForm.Designer.cs" />
    <Compile Include="Functions\AddSignatureDWG.cs" />
    <Compile Include="App.cs" />
    <Compile Include="Functions\DeleteSignatureDWG.cs" />
    <Compile Include="Forms\InfoListForm.cs">
      <SubType>Form</SubType>
    </Compile>
    <Compile Include="Forms\InfoListForm.Designer.cs" />
    <Compile Include="Properties\appSettings.Designer.cs">
      <AutoGen>True</AutoGen>
      <DesignTimeSharedInput>True</DesignTimeSharedInput>
      <DependentUpon>appSettings.settings</DependentUpon>
    </Compile>
    <Compile Include="Properties\AssemblyInfo.cs" />
    <Compile Include="Functions\WhoDidThat.cs" />
    <Compile Include="Functions\RenameSheets.cs" />
    <Compile Include="Forms\RenameSheetsForm.cs">
      <SubType>Form</SubType>
    </Compile>
    <Compile Include="Forms\RenameSheetsForm.Designer.cs" />
	-->
  
    <None Remove="Resources\fixIFCcoord_32.png" />
  
    <None Remove="Resources\sortIntoWorkgroups_32.png" />
  
    <None Remove="Resources\vitruvius_ico_16.png" />
  </ItemGroup>
	
  <ItemGroup>
    <Resource Include="Resources\add.png" />
  </ItemGroup>
	
  <ItemGroup>
    <Resource Include="Resources\delete.png" />
  </ItemGroup>
	
  <ItemGroup>
    <Resource Include="Resources\fakeArea.png" />
    <Resource Include="Resources\fixIFCcoord_32.png" />
    <Resource Include="Resources\replaceTags.png" />
    <Resource Include="Resources\copyLists.png" />
    <Resource Include="Resources\sortIntoWorkgroups_32.png" />
    <Resource Include="Resources\vitruvius_ico_16.png" />
    <Resource Include="Resources\whoDidThat.png" />
    <Resource Include="Resources\pdf.png" />
    <Resource Include="Resources\renumber.png" />
    <Resource Include="Resources\infoLists.png" />
    <Resource Include="Resources\whatDidTheyDo.png" />
    <Resource Include="Resources\colorizeTabs.png" />
    <Resource Include="Resources\palette.png" />
    <Resource Include="Resources\stampFill.png" />
    <Resource Include="Resources\add_16.png" />
    <Resource Include="Resources\delete_16.png" />
    <Resource Include="Resources\stampFill_16.png" />
    <Resource Include="Resources\copyLists_16.png" />
    <Resource Include="Resources\pdf_16.png" />
    <Resource Include="Resources\renumber_16.png" />
    <Resource Include="Resources\info.png" />
    <Resource Include="Resources\dwgExport.png" />
    <Resource Include="Resources\dwgExport_16.png" />
    <Resource Include="Resources\fixMirroredDoors.png" />
    <Resource Include="Resources\floor.png" />
    <Resource Include="Resources\numerateRooms.png" />
    <Content Include="SKRibbon.addin">
      <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
    </Content>
  </ItemGroup>
	
  <ItemGroup>
	  <!--
    <EmbeddedResource Include="Forms\AddSigForm.resx">
      <DependentUpon>AddSigForm.cs</DependentUpon>
    </EmbeddedResource>
    <EmbeddedResource Include="Forms\ChangeColorSettingsForm.resx">
      <DependentUpon>ChangeColorSettingsForm.cs</DependentUpon>
    </EmbeddedResource>
    <EmbeddedResource Include="Forms\DeleteSigForm.resx">
      <DependentUpon>DeleteSigForm.cs</DependentUpon>
    </EmbeddedResource>
    <EmbeddedResource Include="Forms\FillStampsForm.resx">
      <DependentUpon>FillStampsForm.cs</DependentUpon>
    </EmbeddedResource>
    <EmbeddedResource Include="Forms\InfoForm.resx">
      <DependentUpon>InfoForm.cs</DependentUpon>
    </EmbeddedResource>
    <EmbeddedResource Include="Forms\NewTotalForm.resx">
      <DependentUpon>NewTotalForm.cs</DependentUpon>
    </EmbeddedResource>
    <EmbeddedResource Include="Forms\PlaceFloorsForm.resx">
      <DependentUpon>PlaceFloorsForm.cs</DependentUpon>
    </EmbeddedResource>
    <EmbeddedResource Include="Forms\replaceTagsForm.resx">
      <DependentUpon>replaceTagsForm.cs</DependentUpon>
    </EmbeddedResource>
	-->
  </ItemGroup>
	
  <ItemGroup>
    <COMReference Include="Microsoft.Office.Core">
      <Guid>{2DF8D04C-5BFA-101B-BDE5-00AA0044DE52}</Guid>
      <VersionMajor>2</VersionMajor>
      <VersionMinor>8</VersionMinor>
      <Lcid>0</Lcid>
      <WrapperTool>primary</WrapperTool>
      <Isolated>False</Isolated>
      <EmbedInteropTypes>True</EmbedInteropTypes>
    </COMReference>
  </ItemGroup>
	
  <ItemGroup>
    <None Include="app.config" />
    <None Include="packages.config" />
    <None Include="Properties\appSettings.settings">
      <Generator>SettingsSingleFileGenerator</Generator>
      <LastGenOutput>appSettings.Designer.cs</LastGenOutput>
    </None>
  </ItemGroup>

	<PropertyGroup>
		<PostBuildEvent>
			if exist "$(AppData)\Autodesk\REVIT\Addins\$(RevitVersion)" copy "$(SolutionDir)$(AssemblyName)\*.addin" "$(AppData)\Autodesk\REVIT\Addins\$(RevitVersion)"
			if exist "$(AppData)\Autodesk\REVIT\Addins\$(RevitVersion)" copy "$(SolutionDir)$(AssemblyName)\$(OutputPath)*.dll" "$(AppData)\Autodesk\REVIT\Addins\$(RevitVersion)"
		</PostBuildEvent>
	</PropertyGroup>

	<Target Name="CleanRevitAddin" BeforeTargets="CoreClean">
	    <Message Text="Clean Revit Files" Importance="High" />
		<Delete Files="$(AppData)\Autodesk\REVIT\Addins\$(RevitVersion)\$(AssemblyName).addin" />
		<Delete Files="$(AppData)\Autodesk\REVIT\Addins\$(RevitVersion)\$(AssemblyName).dll" />
	</Target>
	
	<!--
  <PropertyGroup>
    <PostBuildEvent>if exist "$(AppData)\Autodesk\REVIT\Addins\2021" copy "$(ProjectDir)*.addin" "$(AppData)\Autodesk\REVIT\Addins\2021"
if exist "$(AppData)\Autodesk\REVIT\Addins\2021" copy "$(ProjectDir)$(OutputPath)*.dll" "$(AppData)\Autodesk\REVIT\Addins\2021"</PostBuildEvent>
  </PropertyGroup>
  -->
</Project>